!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e,t){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=n(2),i=o(r),u=n(3),a=o(u),s=n(4),l=o(s),c=n(5),f=(o(c),n(6)),d=o(f),p=n(7),v=o(p),g=n(8),m=o(g),b=n(11),h=o(b),w=n(10),y=o(w),_=new h["default"];_.cfg({consoleLevel:"debug",fileLevel:"error"}),y["default"].connect("mongodb://api:!AgileRules4#@ds062059.mlab.com:62059/mic-pro").then(function(){_.log("Database is connected")})["catch"](function(e){_.log(e,"error")});var x=process.env.PORT||3e3,j=(0,i["default"])();_.log(e,"error"),j.use((0,l["default"])()),j.use(i["default"]["static"]("dist")),j.use("/app",i["default"]["static"]("./src/client/app")),j.use(d["default"].urlencoded({extended:!0})),j.use(d["default"].json()),j.use((0,v["default"])()),j.use(_.dev),j.set("view engine","ejs"),j.set("views",a["default"].join(t,"../src/server/views/")),j.use("/movies",m["default"]),j.use("/errortest",function(e,t,n){var o={message:"Test route is Testing Error Route",status:509,stack:[{message:"An error test",status:505},{message:"From the Movie test error page",status:501}]};n(o)}),j.use(function(e,t,n,o){_.log(e,"error"),n.status(e.status||500),n.render("pages/error.ejs",{message:e.message,error:{}})}),j.listen(x,function(e){_.log("application started on Port:"+x,"info"),e&&_.log(e)})}).call(t,n(1)(e),"/")},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("method-override")},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=o(r),u=n(9),a=o(u),s=n(11),l=o(s),c=i["default"].Router(),f=new a["default"];new l["default"];c.get("/",f.get),c.post("/",f.save),c.put("/",f.save),c.get("/:id",f.getbyId),c["delete"]("/:id",f.remove),t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),u=o(i),a=n(11),s=o(a),l=n(17),c=o(l),f=new s["default"],d=function p(){r(this,p),f.log("Starting Movie AP","debug");var e=function(e,t,n){u["default"].db.collection("movies").find().toArray().then(function(e){t.json(e)})["catch"](function(e){f.log("Mongo has a problem: "+e,"debug"),n(e)})},t=function(e,t,n){var o=e.body;o._id&&(o._id=new c["default"].ObjectID(o._id.trim())),u["default"].db.collection("movies").save(e.body).then(function(e){null===e?(f.log("Errror on Save adding Movie to the database","debug"),n("Result was null")):t.json(e)})["catch"](function(e){f.log("Mongo has a problem: "+e,"debug"),n(e)})},n=function(e,t,n){f.log("Trying to remove movie is: "+e.params.id.trim(),"info");var o=new c["default"].ObjectID(e.params.id.trim());u["default"].db.collection("movies").remove({_id:o}).then(function(){t.sendStatus(200)})["catch"](function(e){f.log("Mongo has a problem: "+e,"debug"),n(e)})},o=function(e,t,n){var o=new c["default"].ObjectID(e.params.id.trim());u["default"].db.collection("movies").findOne(o).then(function(e){f.log("the movie is "+JSON.stringify(e),"debug"),null===e?(f.log("No record Found","debug"),n("Result was null")):t.json(e)})["catch"](function(e){f.log("Mongo has a problem: "+e,"debug"),n(e)})},i={get:e,getbyId:o,save:t,remove:n};return i};t["default"]=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(11),a=o(u),s=n(17),l=o(s),c=new a["default"],f="",d=function(){function e(){r(this,e)}return i(e,null,[{key:"connect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mongodb://apiuser:!Agile$@ds117839.mlab.com:17839/live-exam-practice";return f=t,l["default"].MongoClient.connect(f).then(function(t){c.log("successful db connection","info"),e.db=t})["catch"](function(e){c.error(e,"error")})}}]),e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=d},function(e,t,n){(function(e){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(12),a=(o(u),n(3)),s=o(a),l=n(13),c=o(l),f=n(14),d=o(f),p=n(15),v=o(p),g=n(16),m=o(g),b=Symbol("winston"),h=null,w={consoleLevel:"info",fileLevel:"error"},y=function(){function t(){var n=this;if(r(this,t),!h){this._timeStamp=this.time;var o=function(){return(0,m["default"])().format("YYYY-MM-DD h:mm:ss a")};d["default"].token("id",function(e){return e.id});var i=s["default"].join(e,"log"),u=(0,c["default"])("request.log",{interval:"1d",path:i});this[b]=new v["default"].Logger({transports:[new v["default"].transports.File({level:w.fileLevel,filename:"app.log",handleExceptions:!0,json:!0,maxsize:5242880,maxFiles:5,colorize:!1,timestamp:!0,prettyprint:!0}),new v["default"].transports.Console({level:w.consoleLevel,handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});var a=function(e){w=e,n[b].transports.console.level=e.consoleLevel,n[b].transports.file.level=e.fileLevel},l={timeStamp:this._timeStamp,time:o,log:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";n[b].log(t,e)},cfg:a,dev:(0,d["default"])(":id :method :status :url :response-time[3]",{stream:u})};h=l}return h}return i(t,[{key:"timeStamp",get:function(){return this._timeStamp}}]),t}();t["default"]=y}).call(t,"/")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("rotating-file-stream")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("mongodb")}]);
//# sourceMappingURL=server.js.map